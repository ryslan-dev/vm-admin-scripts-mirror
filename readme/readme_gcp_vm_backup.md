# üî• GCP VM Backup Creator

–°–∫—Ä–∏–ø—Ç –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ä–µ–∑–µ—Ä–≤–Ω–∏—Ö –∫–æ–ø—ñ–π **GCP VM** —É –≤–∏–≥–ª—è–¥—ñ **Snapshots**, **Images** —Ç–∞ **Configs**. –ó–±–µ—Ä—ñ–≥–∞—î –ª–æ–∫–∞–ª—å–Ω–æ, –µ–∫—Å–ø–æ—Ä—Ç—É—î –≤ **Google Cloud Storage (GCS)** —Ç–∞ –ø—ñ–¥—Ç—Ä–∏–º—É—î –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ—á–∏—â–µ–Ω–Ω—è —Å—Ç–∞—Ä–∏—Ö –±–µ–∫–∞–ø—ñ–≤.

---

## üì¶ –û—Å–Ω–æ–≤–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ

- üì∏ –°—Ç–≤–æ—Ä–µ–Ω–Ω—è **Snapshots**
- üñº –°—Ç–≤–æ—Ä–µ–Ω–Ω—è **Images**
- üìÑ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è **–∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó VM** (JSON)
- ‚òÅÔ∏è –ï–∫—Å–ø–æ—Ä—Ç –±–µ–∫–∞–ø—ñ–≤ —É **GCS Bucket**
- üßπ –ê–≤—Ç–æ–æ—á–∏—â–µ–Ω–Ω—è —Å—Ç–∞—Ä–∏—Ö –±–µ–∫–∞–ø—ñ–≤ –ª–æ–∫–∞–ª—å–Ω–æ —Ç–∞ –≤ GCS
- üóë –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –ª–æ–∫–∞–ª—å–Ω–∏—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤ –ø—ñ—Å–ª—è –µ–∫—Å–ø–æ—Ä—Ç—É (**–æ–ø—Ü—ñ–π–Ω–æ**)

---

## üöÄ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

```bash
bash gcp-vm-backup.sh \
  --vm=INSTANCE_NAME \
  --zone=ZONE_NAME \
  --type=snapshot,image,config \
  --export-to-gcs \
  --bucket=BUCKET_NAME \
  --keep-last=3 \
  --cleanup-after-export=snapshot,image \
  --log-file=/var/log/vm-backup.log
```

### üìå –ü–∞—Ä–∞–º–µ—Ç—Ä–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä                 | –û–ø–∏—Å                                                                    |
| ------------------------ | ----------------------------------------------------------------------- |
| `--vm=INSTANCE_NAME`     | –Ü–º'—è VM (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º: hostname)                                    |
| `--zone=ZONE_NAME`       | –ó–æ–Ω–∞ VM (–∞–≤—Ç–æ–≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è, —è–∫—â–æ –Ω–µ –≤–∫–∞–∑–∞–Ω–æ)                               |
| `--project=PROJECT_ID`   | –ü—Ä–æ—î–∫—Ç GCP (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º: –∞–∫—Ç–∏–≤–Ω–∏–π –ø—Ä–æ—î–∫—Ç —É gcloud)                 |
| `--type=TYPE`            | –¢–∏–ø–∏ –±–µ–∫–∞–ø—ñ–≤: `snapshot`, `image`, `config`, –∞–±–æ `all`                  |
| `--export-to-gcs`        | –ï–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ —É GCS (—É—Å—ñ —Ç–∏–ø–∏)                                           |
| `--export-to-gcs=TYPE`   | –ï–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ —Ç—ñ–ª—å–∫–∏ –∑–∞–∑–Ω–∞—á–µ–Ω—ñ —Ç–∏–ø–∏                                      |
| `--bucket=BUCKET_NAME`   | –Ü–º'—è –±–∞–∫–µ—Ç—É (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º: `vm-backups-[PROJECT_ID]`)               |
| `--keep-last=N`          | –°–∫—ñ–ª—å–∫–∏ –æ—Å—Ç–∞–Ω–Ω—ñ—Ö –±–µ–∫–∞–ø—ñ–≤ –∑–∞–ª–∏—à–∞—Ç–∏ –ª–æ–∫–∞–ª—å–Ω–æ —Ç–∞ –≤ GCS                     |
| `--storage-class=CLASS`  | –ö–ª–∞—Å –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è GCS (`ARCHIVE`, `NEARLINE`, `STANDARD`, —Ç–æ—â–æ)           |
| `--cleanup-after-export` | –í–∏–¥–∞–ª—è—Ç–∏ –ª–æ–∫–∞–ª—å–Ω—ñ —Ä–µ—Å—É—Ä—Å–∏ –ø—ñ—Å–ª—è –µ–∫—Å–ø–æ—Ä—Ç—É: `all`, `snapshot,image`, —Ç–æ—â–æ |
| `--log-file=PATH`        | –õ–æ–≥-—Ñ–∞–π–ª –¥–ª—è –∑–∞–ø–∏—Å—É –≤–∏–≤–æ–¥—É                                              |

---

## üßπ –ê–≤—Ç–æ–æ—á–∏—â–µ–Ω–Ω—è

- **–õ–æ–∫–∞–ª—å–Ω–æ**: –∑–∞–ª–∏—à–∞—î —Ç—ñ–ª—å–∫–∏ –æ—Å—Ç–∞–Ω–Ω—ñ `--keep-last` –±–µ–∫–∞–ø—ñ–≤ –∫–æ–∂–Ω–æ–≥–æ —Ç–∏–ø—É
- **–£ GCS**: –≤–∏–¥–∞–ª—è—î —Å—Ç–∞—Ä—ñ —Ñ–∞–π–ª–∏, –∑–∞–ª–∏—à–∞—é—á–∏ –æ—Å—Ç–∞–Ω–Ω—ñ `--keep-last`
- **–ü—ñ—Å–ª—è –µ–∫—Å–ø–æ—Ä—Ç—É** (–æ–ø—Ü—ñ–π–Ω–æ): –≤–∏–¥–∞–ª—è—î –ª–æ–∫–∞–ª—å–Ω—ñ Snapshots, Images –∞–±–æ Configs

---

## üìñ –ü—Ä–∏–∫–ª–∞–¥–∏

### 1Ô∏è‚É£ –°—Ç–≤–æ—Ä–∏—Ç–∏ –≤—Å—ñ —Ç–∏–ø–∏ –±–µ–∫–∞–ø—ñ–≤ —Ç–∞ –µ–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –≤ GCS

```bash
bash gcp-vm-backup.sh --vm=my-instance --zone=europe-west1-b --type=all --export-to-gcs
```

### 2Ô∏è‚É£ –¢—ñ–ª—å–∫–∏ Snapshots + –∞–≤—Ç–æ–æ—á–∏—â–µ–Ω–Ω—è –ø—ñ—Å–ª—è –µ–∫—Å–ø–æ—Ä—Ç—É

```bash
bash gcp-vm-backup.sh --type=snapshot --export-to-gcs --cleanup-after-export
```

### 3Ô∏è‚É£ Image —Ç–∞ Config –±–µ–∑ –µ–∫—Å–ø–æ—Ä—Ç—É

```bash
bash gcp-vm-backup.sh --type=image,config
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–æ–∫–∞–ª—å–Ω–∏—Ö –±–µ–∫–∞–ø—ñ–≤

```
/var/backups/
‚îú‚îÄ‚îÄ snapshots/
‚îÇ   ‚îî‚îÄ‚îÄ my-instance-snapshot_YYYY-MM-DD_HH-MM-SS
‚îú‚îÄ‚îÄ images/
‚îÇ   ‚îî‚îÄ‚îÄ my-instance-image_YYYY-MM-DD_HH-MM-SS
‚îî‚îÄ‚îÄ vm-configs/
    ‚îî‚îÄ‚îÄ my-instance-config_YYYY-MM-DD_HH-MM-SS.json
```

---

## ‚úÖ –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ

- [gcloud CLI](https://cloud.google.com/sdk)
- [gsutil](https://cloud.google.com/storage/docs/gsutil)

---

## ‚ö†Ô∏è –ü–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è

- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –∑ –æ–±–ª—ñ–∫–æ–≤–∏–º –∑–∞–ø–∏—Å–æ–º —ñ–∑ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–º–∏ –ø—Ä–∞–≤–∞–º–∏ —É GCP.
- –ü–µ—Ä–µ–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ —É –≤–∞—Å –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π `gcloud` —Ç–∞ `gsutil`.

---

## üë©‚Äçüíª –ê–≤—Ç–æ—Ä

> –°—Ç–≤–æ—Ä–µ–Ω–æ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è —É GCP.

