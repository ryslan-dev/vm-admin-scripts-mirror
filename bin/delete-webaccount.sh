#!/bin/bash

# === –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∞—Ä–≥—É–º–µ–Ω—Ç—ñ–≤ ===
if [[ -z "$1" ]]; then
  echo "‚ùå –ü–æ–º–∏–ª–∫–∞: –≤–∫–∞–∂–∏ —ñ–º‚Äô—è –∞–∫–∞—É–Ω—Ç–∞ —è–∫ –∞—Ä–≥—É–º–µ–Ω—Ç."
  echo "   –ü—Ä–∏–∫–ª–∞–¥: $0 interkam [--force]"
  exit 1
fi

user="$1"
user_home="/var/www/$user"
FORCE=0

# === –û–±—Ä–æ–±–∫–∞ –¥—Ä—É–≥–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç—É ===
if [[ "$2" == "--force" ]]; then
  FORCE=1
fi

# === –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è ===
if [[ "$FORCE" -ne 1 ]]; then
  read -rp "‚ö†Ô∏è –£–≤–∞–≥–∞: –±—É–¥–µ –≤–∏–¥–∞–ª–µ–Ω–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ '$user' —ñ –∫–∞—Ç–∞–ª–æ–≥ '$user_home'. –ü—Ä–æ–¥–æ–≤–∂–∏—Ç–∏? [y/N] " confirm
  if [[ "$confirm" != [yY] ]]; then
    echo "‚ùå –°–∫–∞—Å–æ–≤–∞–Ω–æ."
    exit 0
  fi
else
  echo "‚öôÔ∏è –ó–∞–ø—É—â–µ–Ω–æ –≤ —Ä–µ–∂–∏–º—ñ --force (–±–µ–∑ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è)"
fi

# === –í–∏–¥–∞–ª–µ–Ω–Ω—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ ===
if id "$user" &>/dev/null; then
  echo "üë§ –í–∏–¥–∞–ª—è—î–º–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ $user..."
  sudo userdel -r "$user" 2>/dev/null || {
    echo "‚ö†Ô∏è –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤–∏–¥–∞–ª–µ–Ω–æ, –∞–ª–µ –¥–æ–º–∞—à–Ω—è –ø–∞–ø–∫–∞ –∑–∞–ª–∏—à–∏–ª–∞—Å—å –∞–±–æ –±—É–ª–∞ –∑–æ–≤–Ω—ñ—à–Ω—å–æ—é."
  }
else
  echo "‚ÑπÔ∏è –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ $user –Ω–µ —ñ—Å–Ω—É—î –∞–±–æ –≤–∂–µ –≤–∏–¥–∞–ª–µ–Ω–æ."
fi

# === –í–∏–¥–∞–ª–µ–Ω–Ω—è –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó –∞–∫–∞—É–Ω—Ç–∞ ===
if [[ -d "$user_home" ]]; then
  echo "üóëÔ∏è –í–∏–¥–∞–ª—è—î–º–æ –∫–∞—Ç–∞–ª–æ–≥ $user_home ..."
  sudo rm -rf "$user_home"
else
  echo "‚ÑπÔ∏è –ö–∞—Ç–∞–ª–æ–≥ $user_home –Ω–µ —ñ—Å–Ω—É—î."
fi

echo "‚úÖ –ê–∫–∞—É–Ω—Ç $user –ø–æ–≤–Ω—ñ—Å—Ç—é –≤–∏–ª—É—á–µ–Ω–æ."
